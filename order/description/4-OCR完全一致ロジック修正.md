# OCR完全一致ロジック修正

## 問題
OCR結果の文字列（例: "コンポジットレジン A2"）とデータベース内の商品名が完全に一致しているにもかかわらず、OCR処理後の類似度スコアが低く（約70%）、UI上で「候補（High Confidence）」ではなく「おすすめ（Recommendation）」として表示されてしまう現象が発生。

## 原因調査
1. **Frontend (`src/components/OCRModal.tsx`)**:
   - 類似度 `0.8` (80%) 以上を「候補」、未満を「おすすめ」と判定している。
   - 70%では「おすすめ」になるのは仕様通り。

2. **Backend (`src/app/api/ocr/route.ts`)**:
   - `pgvector` を用いたベクトル検索（Cosine Similarity）のみを行っている。
   - 検索時のEmbedding生成は「抽出された商品名」のみで行われている。

3. **Embedding Generation (`backend/scripts/inject_embeddings_to_sql.py`)**:
   - データベースに保存されているEmbeddingは「商品名 + 商品説明」のテキストから生成されていることが判明。
   - `text = f"Product Name: {name}\nDescription: {desc}"`
   - このため、「商品名のみ」のベクトルと「商品名+説明」のベクトルを比較することになり、完全一致する商品名であっても類似度が1.0にならず、0.7程度に留まっていた。

## 対応内容
ベクトル検索の前に、**完全一致（大文字小文字無視）する商品名をテキスト検索する処理**を追加した。

### 修正前
- OCR商品名 -> Embedding生成 -> ベクトル検索 -> 上位候補

### 修正後
1. **テキスト検索**: OCR商品名と `name` が完全一致（`equals`, `mode: insensitive`）する商品を検索。
   - ヒットした場合、その商品の類似度を強制的に `1.0` (100%) に設定。
2. **ベクトル検索**: 従来通りEmbeddingを用いた検索を実行。
3. **結果統合**: テキスト検索で見つかった商品とベクトル検索の結果をマージ（重複排除）。

## 結果
これにより、OCRで読み取った名称が商品マスタに存在する場合は、確実に「候補（100%一致）」として最上位に表示されるようになった。

