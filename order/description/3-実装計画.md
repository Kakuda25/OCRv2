# 実装計画：Next.js フルスタック構成

## 1. プロジェクト初期化・環境構築
- [ ] **Next.js プロジェクトの作成**
    - TypeScript, Tailwind CSS, ESLint, App Router を有効化
    - 必要な依存パッケージのインストール (`pg`, `prisma`, `@google/generative-ai` 等)
- [ ] **Docker 環境の整理**
    - `docker-compose.yml` を更新し、Node.js アプリと PostgreSQL の構成にする
    - 不要になった Python 関連の設定を削除

## 2. データベース連携 (Prisma)
- [ ] **Prisma セットアップ**
    - `schema.prisma` の作成（既存のDBスキーマに合わせてモデル定義）
    - `pgvector` 拡張のサポート設定
- [ ] **データシード・移行ツールの実装 (TypeScript)**
    - 既存の Python スクリプト (`seed_embeddings.py` 等) のロジックを TypeScript (`prisma/seed.ts`) に移植
    - `npm run seed` で DB 初期化とベクトルデータの生成が行えるようにする

## 3. クリーンアップ
- [ ] **Python 関連ファイルの削除**
    - `backend/` ディレクトリごとの削除
    - 関連するドキュメントの更新

## 4. バックエンド API 実装 (Next.js Route Handlers)
- [x] **Gemini API 連携クライアント**
    - 画像OCR処理、Embedding生成のユーティリティ作成
- [x] **API エンドポイント作成**
    - [x] `/api/ocr`: 画像を受け取り、OCR結果と検索候補（ベクトル検索）を返す
    - `/api/products`: 商品一覧取得、検索
    - [x] `/api/orders`: 発注処理（カート確定）

## 5. フロントエンド実装
- [x] **共通コンポーネント作成**
    - Layout
    - Header
        - 左側: アプリロゴ（TOP/商品一覧へ遷移）
        - 右側: ナビゲーションリンク（発注済み一覧、商品登録）
        - 右端: カートアイコン（バッジ付き、どのページからもアクセス可能に）
    - Button, Modal
- [x] **商品一覧ページ (TOP)**
    - レイアウト改修
        - ヘッダー下・商品一覧テーブル上に操作エリアを配置 (Stickyで上部に固定)
        - [x] **OCR検索ボタン** (操作エリア内)
        - [x] **商品名検索テキストボックス** (操作エリア内)
        - [x] **カテゴリ選択プルダウン** (操作エリア内)
    - 商品カード/リスト表示
        - [x] **無限スクロール (Infinite Scroll)** 実装（ページネーションの代わり）
    - [x] カート追加機能（Context/Zustand等で状態管理）
- [x] **OCR検索モーダル**
    - [x] 画像アップロード UI
    - [x] 検索結果・おすすめ商品の表示 UI (候補とおすすめの区別・色分け対応中)
- [x] **カート・発注フロー**
    - [x] カート内容確認、数量変更
    - [x] 発注確定処理
- [ ] **発注済み一覧ページ**
    - 過去の発注履歴表示
    - 発注明細詳細表示
- [x] **商品登録ページ**
    - 商品情報の新規登録フォーム
    - カテゴリ登録機能 (商品登録ページからの遷移またはモーダル)

## 6. テスト・デプロイ準備
- [ ] **E2E テスト / 動作確認**
- [ ] **README / ドキュメント整備**

