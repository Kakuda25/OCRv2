{
  "meta": {
    "project": "OCRv2",
    "version": "1.0",
    "created_by": "agent",
    "created_at": "2025-12-03T00:00:00Z"
  },
  "todos": [
    {
      "id": 1,
      "title": "初期スキーマ定義",
      "description": "進捗管理のJSONスキーマを定義する",
      "status": "completed",
      "created_at": "2025-12-03T00:00:00Z",
      "updated_at": "2025-12-03T00:00:00Z",
      "owner": "agent",
      "priority": "high",
      "tags": [
        "setup"
      ],
      "logs": [
        {
          "timestamp": "2025-12-03T00:00:00Z",
          "author": "agent",
          "message": "スキーマ案を作成・初期タスク完了"
        }
      ],
      "artifacts": [
        "order/初期化.md"
      ],
      "related": []
    },
    {
      "id": 2,
      "title": "要件定義とDB設計分析",
      "description": "プロジェクト要件を確認し、必要なDBスキーマの変更点を洗い出し、要件定義書を作成する。",
      "status": "completed",
      "created_at": "2026-01-05T09:00:00Z",
      "updated_at": "2026-01-05T09:00:00Z",
      "owner": "agent",
      "priority": "high",
      "tags": [
        "planning",
        "database"
      ],
      "logs": [
        {
          "timestamp": "2026-01-05T09:00:00Z",
          "author": "agent",
          "message": "プロジェクト要件と既存DBを確認し、要件定義書を作成しました。productsテーブルへのカテゴリ・ベクトルカラム追加、categoriesテーブルの新設が必要です。"
        }
      ],
      "artifacts": [
        "order/description/2-要件定義.md"
      ],
      "related": []
    },
    {
      "id": 3,
      "title": "カート・発注機能の実装",
      "description": "Zustandを用いたカート状態管理、カートUI、発注API、発注完了フローの実装",
      "status": "completed",
      "created_at": "2026-01-05T10:00:00Z",
      "updated_at": "2026-01-05T10:00:00Z",
      "owner": "agent",
      "priority": "high",
      "tags": [
        "frontend",
        "backend",
        "feature"
      ],
      "logs": [
        {
          "timestamp": "2026-01-05T10:00:00Z",
          "author": "agent",
          "message": "Zustandストア作成、カートページ、発注API(/api/orders)、商品一覧へのカート追加ボタン実装完了。"
        }
      ],
      "artifacts": [
        "src/lib/store.ts",
        "src/app/cart/page.tsx",
        "src/app/api/orders/route.ts",
        "src/components/AddToCartButton.tsx",
        "src/components/CartIcon.tsx"
      ],
      "related": []
    },
    {
      "id": 4,
      "title": "OCR機能の実装",
      "description": "Gemini APIを用いたOCR処理、Embedding生成、pgvectorによる類似検索、およびOCR結果表示用モーダルUIの実装",
      "status": "completed",
      "created_at": "2026-01-05T11:00:00Z",
      "updated_at": "2026-01-05T11:00:00Z",
      "owner": "agent",
      "priority": "high",
      "tags": [
        "frontend",
        "backend",
        "ai"
      ],
      "logs": [
        {
          "timestamp": "2026-01-05T11:00:00Z",
          "author": "agent",
          "message": "Gemini 1.5 Flashを用いた画像解析処理、pgvectorによる類似商品検索API、結果選択・カート追加が可能なモーダルUIを実装しました。"
        }
      ],
      "artifacts": [
        "src/lib/gemini.ts",
        "src/app/api/ocr/route.ts",
        "src/components/OCRModal.tsx"
      ],
      "related": []
    },
    {
      "id": 5,
      "title": "データ投入プロセスの修正",
      "description": "Docker初期化スクリプトとPrisma Migrateの競合を解消し、正しいセットアップ手順を確立する",
      "status": "completed",
      "created_at": "2026-01-06T00:00:00Z",
      "updated_at": "2026-01-06T00:00:00Z",
      "owner": "agent",
      "priority": "high",
      "tags": [
        "database",
        "bugfix"
      ],
      "logs": [
        {
          "timestamp": "2026-01-06T00:00:00Z",
          "author": "agent",
          "message": "Docker Composeの初期化スクリプトマウントを削除し、Prisma Seedで全データを投入するように修正しました。README.mdの手順も更新しました。"
        }
      ],
      "artifacts": [
        "prisma/seed.ts",
        "docker-compose.yml",
        "prisma/schema.prisma",
        "README.md"
      ],
      "related": []
    },
    {
      "id": 6,
      "title": "OCR完全一致ロジック修正",
      "description": "OCR結果と商品名が完全一致する場合でも類似度が低く出る問題を修正する",
      "status": "completed",
      "created_at": "2026-01-06T12:00:00Z",
      "updated_at": "2026-01-06T12:00:00Z",
      "owner": "agent",
      "priority": "high",
      "tags": [
        "bugfix",
        "backend"
      ],
      "logs": [
        {
          "timestamp": "2026-01-06T12:00:00Z",
          "author": "agent",
          "message": "OCR結果名とDB商品名の完全一致検索を追加し、一致時は類似度1.0とする処理を実装しました。"
        }
      ],
      "artifacts": [
        "src/app/api/ocr/route.ts",
        "order/description/4-OCR完全一致ロジック修正.md"
      ],
      "related": []
    },
    {
      "id": 7,
      "title": "Embeddingモデルの変更 (Gemini 3 Flash Preview)",
      "description": "Embeddingモデルをtext-embedding-004からgemini-3-flash-previewに変更し、再ベクター化を試みる。",
      "status": "blocked",
      "created_at": "2026-01-06T13:00:00Z",
      "updated_at": "2026-01-06T13:10:00Z",
      "owner": "agent",
      "priority": "medium",
      "tags": [
        "backend",
        "embedding"
      ],
      "logs": [
        {
          "timestamp": "2026-01-06T13:05:00Z",
          "author": "agent",
          "message": "gemini-3-flash-previewおよびgemini-2.0-flash-expを指定して再ベクター化を試みましたが、APIが404エラー（モデルが見つからない、またはembedContent非対応）を返しました。text-embedding-004に戻しました。"
        }
      ],
      "artifacts": [
        "backend/scripts/seed_embeddings.py",
        "src/lib/gemini.ts"
      ],
      "related": []
    },
    {
      "id": 8,
      "title": "発注済み一覧ページの実装",
      "description": "過去の発注履歴と明細を表示するページのUIおよびAPI実装",
      "status": "completed",
      "created_at": "2026-01-06T14:00:00Z",
      "updated_at": "2026-01-06T14:00:00Z",
      "owner": "agent",
      "priority": "high",
      "tags": [
        "frontend",
        "backend",
        "feature"
      ],
      "logs": [
        {
          "timestamp": "2026-01-06T14:00:00Z",
          "author": "agent",
          "message": "発注履歴取得API(GET /api/orders)の実装、および発注済み一覧ページ(src/app/orders/page.tsx)のUI実装を完了しました。BigIntのJSONシリアライズ対応も行いました。"
        }
      ],
      "artifacts": [
        "src/app/api/orders/route.ts",
        "src/app/orders/page.tsx"
      ],
      "related": []
    },
    {
      "id": 9,
      "title": "商品登録ページの実装",
      "description": "商品登録ページのUI、POST API実装、および商品登録時のEmbedding生成処理の実装",
      "status": "completed",
      "created_at": "2026-01-06T15:00:00Z",
      "updated_at": "2026-01-06T15:00:00Z",
      "owner": "agent",
      "priority": "high",
      "tags": [
        "frontend",
        "backend",
        "feature"
      ],
      "logs": [
        {
          "timestamp": "2026-01-06T15:00:00Z",
          "author": "agent",
          "message": "商品登録API(POST /api/products)の実装、PrismaトランザクションによるEmbedding生成・保存、および商品登録フォームUIの実装を完了しました。"
        }
      ],
      "artifacts": [
        "src/app/api/products/route.ts",
        "src/app/products/new/page.tsx",
        "src/components/ProductCreateForm.tsx"
      ],
      "related": []
    },
    {
      "id": 10,
      "title": "商品コード自動採番機能の実装",
      "description": "商品登録時、商品コードを既存の数値のみのコードの最大値+1で自動採番するように変更する。",
      "status": "completed",
      "created_at": "2026-01-06T15:30:00Z",
      "updated_at": "2026-01-06T15:30:00Z",
      "owner": "agent",
      "priority": "medium",
      "tags": [
        "backend",
        "frontend",
        "feature"
      ],
      "logs": [
        {
          "timestamp": "2026-01-06T15:30:00Z",
          "author": "agent",
          "message": "APIでproductCode未指定時に最大値+1を自動設定するロジックを追加し、UIから商品コード入力欄を削除しました。"
        }
      ],
      "artifacts": [
        "src/app/api/products/route.ts",
        "src/components/ProductCreateForm.tsx"
      ],
      "related": []
    },
    {
      "id": 11,
      "title": "Embedding生成パラメータの不一致修正",
      "description": "OCR検索結果に無関係な商品が高スコアで表示される問題を解決するため、Embedding生成時のtaskTypeとフォーマットを統一する。",
      "status": "completed",
      "created_at": "2026-01-06T16:00:00Z",
      "updated_at": "2026-01-06T16:00:00Z",
      "owner": "agent",
      "priority": "high",
      "tags": [
        "backend",
        "ai",
        "bugfix"
      ],
      "logs": [
        {
          "timestamp": "2026-01-06T16:00:00Z",
          "author": "agent",
          "message": "商品登録時はRETRIEVAL_DOCUMENT、検索時はRETRIEVAL_QUERYを指定するように修正し、テキストフォーマットもPythonスクリプトと統一しました。"
        }
      ],
      "artifacts": [
        "src/lib/gemini.ts",
        "src/app/api/products/route.ts",
        "src/app/api/ocr/route.ts"
      ],
      "related": []
    }
  ]
}
